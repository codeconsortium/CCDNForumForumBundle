{%- spaceless -%}
<hr>

<div style="border-left:5px solid #99caff;padding-top:1px;padding-bottom:5px;vertical-align:top;">
	<div style="display:block;min-height:120px;vertical-align:top;" id="post_{{- post.getId -}}">
		
		<div style="display:block;float:left;width:110px;margin:0px -115px 0px 0px;padding:0px;overflow:hidden;vertical-align:top;text-align:center;">
			<div style="margin:0px;padding:5px 0;overflow:hidden;vertical-align:top;text-align:center;z-index:3;">

				{%- include 'CCDNUserProfileBundle:Avatar:item_avatar.html.twig' with {'user': post.getCreatedBy, 'scale_x':80, 'scale_y':80, 'border': 1, 'padding': 4, } -%}
				
			</div>
		</div>
	
		<div style="display:block;padding:0px;{#overflow:hidden;#}vertical-align:top;height:90px;">
			<div style="display:block;padding:0px;margin:0px 0px 0px 125px;{#overflow:hidden;#}vertical-align:top;height:90px;">
			
				<div style="display:block;float:none;clear:right;">
					<div class="pull-left" style="padding:5px;vertical-align:bottom;">
						{%- if post.getCreatedBy -%}
							{{- 'ccdn_forum_forum.post.posted_by' |trans({}, 'CCDNForumForumBundle') -}}<a href="{{- path(user_profile_route, {'userId': post.getCreatedBy.getId } ) -}}">{{- post.getCreatedBy |title -}}</a>
						{%- else -%}
							Guest
						{%- endif -%}
						&nbsp;&nbsp;
						<abbr class="timestamper label" style="display:inline-block;" title="{{- post.getCreatedDate |date('Y-m-d H:i:s T Z', 'Europe/London') -}}">{{- post.getCreatedDate |date(param('ccdn_forum_forum.item_post.post_created_datetime_format')) -}}</abbr>
			
						{%- if post.getEditedDate -%}
							&nbsp;&nbsp;
							<span class="label" style="display:inline-block;">
								{{- 'ccdn_forum_forum.post.edited_by' |trans({}, 'CCDNForumForumBundle') -}}
								{%- if post.getEditedBy -%}<a href="{{- path(user_profile_route, {'userId': post.getEditedBy.getId}) -}}">{{- post.getEditedBy.getUsername |title -}}</a>{%- else -%}Guest{%- endif -%}
								{{- 'ccdn_forum_forum.generic.actioned_at' |trans({}, 'CCDNForumForumBundle') -}}
								<abbr class="timestamper" title="{{- post.getEditedDate |date('Y-m-d H:i:s T Z', 'Europe/London') -}}">{{- post.getEditedDate |date(param('ccdn_forum_forum.item_post.post_edited_datetime_format')) -}}</abbr>
							</span>
						{%- endif -%}
					</div>
				
					<div class="pull-right">
						<div class="btn-toolbar" style="margin-top:0px;margin-bottom:0px;vertical-align:top;">
							{%- if post.getIsLocked -%}
								<i class="icon-lock" style="vertical-align:top;margin-top:6px;" data-tip="bottom" title="{{- 'ccdn_forum_forum.post.has_been_locked' |trans({}, 'CCDNForumForumBundle') -}}"></i>&nbsp;&nbsp;
							{%- endif -%}	
							{%- if post.getIsDeleted -%}
								<i class="icon-trash" style="vertical-align:top;margin-top:6px;" data-tip="bottom" title="{{- 'ccdn_forum_forum.post.has_been_deleted' |trans({}, 'CCDNForumForumBundle') -}}"></i>&nbsp;&nbsp;
							{%- endif -%}

							{%- if is_granted('ROLE_USER') -%}
								{%- if post.getCreatedBy -%}
									{%- if post.getCreatedBy.getId != app.user.id -%}
										<a class="btn" style="vertical-align:top;" rel="nofollow" href="{{- path('ccdn_message_message_mail_compose_to', {'userId': post.getCreatedBy.getId }) -}}" data-tip="bottom" title="{{- 'ccdn_forum_forum.link.user.message' | trans({}, 'CCDNForumForumBundle') -}}"><i class="icon-envelope"></i></a>&nbsp;
									{%- endif -%}
								{%- endif -%}
							{%- endif -%}
							
							<div class="btn-group">
								<a class="btn" href="{{- path('ccdn_forum_forum_post_show', {'postId': post.getId }) -}}"><i class="icon-fullscreen"></i></a>
								<a class="btn" href="#post_{{- post.getId -}}"><i class="icon-magnet"></i></a>
							</div>

							{%- if is_granted('ROLE_USER') -%}
								<div class="btn-group">
									<a class="btn dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-cog"></i>&nbsp;<span class="caret"></span></a>
									<ul class="dropdown-menu pull-right" style="z-index:15;">

										<li><a rel="nofollow" href="{{- path('ccdn_forum_forum_topic_reply', {'topicId': post.getTopic.getId }) -}}"><i class="icon-pencil"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.reply' | trans({}, 'CCDNForumForumBundle') -}}</a></li>
										<li><a rel="nofollow" href="{{- path('ccdn_forum_forum_topic_reply_with_quote', {'topicId': post.getTopic.getId, 'quoteId': post.getId }) -}}"><i class="icon-pencil"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.quote' | trans({}, 'CCDNForumForumBundle') -}}</a></li>

										{%- if post.getCreatedBy -%}
											{%- if post.getCreatedBy.getId != user.getId -%}
												<li><a rel="nofollow" href="{{- path('ccdn_forum_karma_rate', {'postId': post.getId }) -}}"><i class="icon-thumbs-up"></i>&nbsp;{{- 'ccdn_forum_karma.link.post.rate' | trans({}, 'CCDNForumKarmaBundle') -}}</a></li>
											{%- endif -%}

											{%- if post.getCreatedBy.getId == user.getId and not is_granted('ROLE_MODERATOR') -%}
												<li><a rel="nofollow" href="{{- path('ccdn_forum_forum_post_edit', {'postId': post.getId }) -}}"><i class="icon-pencil"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.edit' | trans({}, 'CCDNForumForumBundle') -}}</a></li>
												{%- if not post.getDeletedBy -%}
													<li><a rel="nofollow" href="{{- path('ccdn_forum_forum_post_delete', {'postId': post.getId }) -}}"><i class="icon-trash"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.delete' | trans({}, 'CCDNForumForumBundle') -}}</a></li>
												{%- endif -%}
											{%- endif -%}
										{%- endif -%}

										{%- if is_granted('ROLE_MODERATOR') -%}
										<li><a rel="nofollow" href="{{- path('ccdn_forum_forum_post_edit', {'postId': post.getId }) -}}"><i class="icon-pencil"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.edit' | trans({}, 'CCDNForumForumBundle') -}}</a></li>

											{%- if post.getDeletedBy -%}
												<li><a rel="nofollow" href="{{- path('ccdn_forum_admin_post_restore', {'postId': post.getId }) -}}"><i class="icon-trash"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.restore' | trans({}, 'CCDNForumForumBundle') -}}</a></li>
											{%- else -%}
												<li><a rel="nofollow" href="{{- path('ccdn_forum_forum_post_delete', {'postId': post.getId }) -}}"><i class="icon-trash"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.delete' | trans({}, 'CCDNForumForumBundle') -}}</a></li>				
											{%- endif -%}
	
											{%- if post.getLockedBy -%}
												<li><a rel="nofollow" href="{{- path('ccdn_forum_admin_post_unlock', {'postId': post.getId }) -}}"><i class="icon-lock"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.unlock' | trans({}, 'CCDNForumForumBundle') -}}</a></li>
											{%- else -%}
												<li><a rel="nofollow" href="{{- path('ccdn_forum_admin_post_lock', {'postId': post.getId }) -}}"><i class="icon-lock"></i>&nbsp;{{- 'ccdn_forum_forum.link.post.lock' | trans({}, 'CCDNForumForumBundle') -}}</a></li>
											{%- endif -%}
										{%- endif -%}
									</ul>
								</div>
							{%- endif -%}

						</div>
					</div>
				</div>
						
				<div style="display:block;float:none;clear:right;">
					<div class="pull-left">
						{%- if registries[post.getCreatedBy().getId()] is defined -%}												
							{#<div style="clear:both;text-align:left;vertical-align:middle;">
								<img class="icon16" width="16" height="16" src="{{- asset('bundles/ccdncomponentcommon/images/icons/Black/16x16/16x16_karma.png') -}}" alt="icon">&nbsp;
								<span class="badge badge-important">{{- registries[post.getCreatedBy().getId()].getCachedKarmaNegativeCount -}}</span>&nbsp;
								<span class="badge badge-success">{{- registries[post.getCreatedBy().getId()].getCachedKarmaPositiveCount -}}</span>
							</div>#}

							<span class="label">{{- 'ccdn_forum_forum.post.user.post_count' | trans({'%post_count%': registries[post.getCreatedBy().getId()].getCachedPostCount()}, 'CCDNForumForumBundle') -}}</span>
						{%- endif -%}

						{%- if post.getCreatedBy() -%}
							<br>
							{%- include 'CCDNUserProfileBundle:Account:item_role_badge.html.twig' with {'user': post.getCreatedBy(), } -%}
						{%- endif -%}
					</div>
				</div>
				
			</div>
		</div>
	
	</div>
		
	<div style="display:block;clear:both;float:none;">
		<div style="display:block;clear:both;padding-left:10px;">
							
			{%- if post.getIsDeleted -%}
				<span class="alert alert-warning" style="display:block;">
				<i class="icon-trash"></i>&nbsp;
				{{- 'ccdn_forum_forum.post.is_deleted' | trans({}, 'CCDNForumForumBundle') -}}&nbsp; 
				{{- 'ccdn_forum_forum.post.deleted_by' |trans({}, 'CCDNForumForumBundle') -}}
				{%- if post.getDeletedBy -%}<a href="{{- path(user_profile_route, {'userId': post.getDeletedBy.getId }) -}}">{{- post.getDeletedBy.getUsername |title -}}</a>{%- else -%}Guest{%- endif -%}
				{{- 'ccdn_forum_forum.generic.actioned_at' |trans({}, 'CCDNForumForumBundle') -}}{{- relevantDateFormat(post.getDeletedDate) -}}{#|date(param('ccdn_forum_forum.item_post.post_deleted_datetime_format')) #}
				</span>
			{%- endif -%}

			{%- if post.getIsDeleted == false or is_granted('ROLE_MODERATOR') -%}
				{%- if post.getIsDeleted == true -%}
					<div class="accordion" id="post_{{- post.getId() -}}">
						<div class="accordion-group">
							<div class="accordion-heading">
								<a class="accordion-toggle" data-toggle="collapse" data-parent="#post_{{- post.getId() -}}" href="#post_{{- post.getId() -}}_body">{{- 'ccdn_forum_forum.post.show_hide' |trans({}, 'CCDNForumForumBundle') -}}</a>
							</div>
							<div id="post_{{- post.getId() -}}_body" class="accordion-body collapse">
								<div class="accordion-inner">
				{%- endif -%}
				
				{%- include 'CCDNForumForumBundle:Post:item_post_body.html.twig' with {'post': post} -%}
			
				{%- if post.getIsDeleted == true -%}			
								</div>
							</div>
						</div>
					</div>
				{%- endif -%}
			{%- endif -%}
		</div>	
	</div>

</div>

<br>
{%- endspaceless -%}